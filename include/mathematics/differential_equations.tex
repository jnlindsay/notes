\chapter{Differential equations}

\section{Linear Ordinary Differential Equations}

\subsection{Forms cheat sheet}

\begin{itemize}
    \item \textbf{Separable}:
        $$ y'(t) = f(t) g(y) . $$
    Solve with
        $$ \int \frac{1}{g(y)} dy = \int f(t) dt . $$
    \item \textbf{Linear}:
        $$ y'(t) + a(t) y(t) = f(t) $$
    Solve with integrating factor (an ansatz)
        $$ \mu(t) = e^{\int a(t) dt} $$
    in
        $$ y(t) = \frac{1}{\mu(t)} \int \mu(t) f(t) dt
            + \frac{C}{\mu(t)} . $$
    \item An ODE of the form
        $$ F(x, y) + G(x, y) \frac{dy}{dx} $$
    is called \textbf{exact} if
        $$ \frac{\partial F}{\partial y}
            = \frac{\partial G}{\partial x} . $$
    \item \textbf{Reduction of order} method: given $u = u_1(x) \neq 0$, a solution to the ODE
        $$ u'' + p(x)u' + q(x)u = 0 , $$
    on some interval $I$, then a second solution is
        $$ u = u_1(x) \int \frac{1}{u_1^2
            \operatorname{exp}\bigl\{ \int p(x) dx \bigr\}} dx . $$
\end{itemize}

\newpage

\subsection{Basic methods}

\begin{problem}{Problem set 1, Q1}{}

    \marginnote{Separable, linear, exact, homogeneous (with solutions).}

    Classify and solve:
        \begin{enumerate}
            \item $4xy' = 5y$
            \item $(x + 1)^2 y' + 3(x + 1)y = 4$
            \item $(x^2 + y^2) y' + 2xy = 0$
            \item $2xy dx + x^2 dy = 0$
        \end{enumerate}

    \tcblower

    \begin{enumerate}
        \item Separable, linear, homogeneous. Rewrite as
            $$ y' = \frac{5y}{4x} . $$
        Then use the technique for separable ODEs:
            \begin{align*}
                \int \frac{1}{5y} dy
                    &= \int \frac{1}{4x} dx \\
                \ln \lvert y \rvert^4
                    &= \ln \lvert x \rvert^5 + c_1 \\
                y &= c_2 x^\frac{5}{4} .
            \end{align*}
        \item Linear, inhomogeneous. Rewrite as
            $$ y' + \frac{3}{x+1}y = \frac{4}{(x+1)^2} . $$
        Then, find an integrating factor:
            \begin{align*}
                \mu(x) &= \exp \biggl\{ 
                    \int \frac{3}{x+1} dx \biggr\} \\
                &= \exp \{ 3 \ln \lvert x + 1 \rvert + c_1 \}] \\
                &= c_2 (x+1)^3 .
            \end{align*}
        Therefore,
            \begin{align*}
                y(x) &= \frac{1}{c_2 (x+1)^3}
                    \int c_2 (x+1)^3 \frac{4}{(x+1)^2} dx
                    + \frac{c_3}{c_2(x+1)^3} \\
                &= \frac{4}{(x+1)^3} \int (x + 1) dx 
                    + \frac{c_4}{(x+1)^3} \\
                &= \frac{2x^2 + 4x}{(x+1)^3}
                    + \frac{c_5}{(x+1)^3} \\
                &= \frac{2(x^2 + 2x + 1) - 2}{(x+1)^3}
                    + \frac{c_5}{(x+1)^3} \\
                &= \frac{2}{x + 1} + \frac{c_6}{(x+1)^3} .
            \end{align*}
        \item Homogeneous. Using the substitution $y = v(x) \cdot x$ gives
            $$ v' = \frac{3v - 3v^3}{1 + v^2} x^{-1} . $$
        Then, using the method for separable equations, we have
            \begin{align*}
                \int \frac{1 + v^2}{-3v - v^3} dv
                    &= \int \frac{1}{x} dx \\
                -\frac{1}{3} \ln \lvert 3v + v^3 \rvert
                    &= \ln \lvert x \rvert + c_1 \\
                3v + v^3 &= \frac{c^3}{x^3} \\
                \frac{3y}{x} + \frac{y^3}{x^3} &= \frac{c^3}{x^3} \\
                y(y^2 + 3x^2) &= c_3 .
            \end{align*}
        \item Separable, linear, exact. Rewrite as
            $$ 2xy \ dx = -x^2 \ dy \implies y' = -\frac{2xy}{x^2}
                = -\frac{2y}{x} $$
        Using the method for separable equations,
            \begin{align*}
                \int -\frac{1}{2y} dy &= \int \frac{1}{x} dx \\
                -\frac{1}{2} \ln \lvert y \rvert
                    &= \ln \lvert x \rvert + c_1 \\
                \ln \lvert y \rvert &= \ln \lvert x \rvert^{-2} + c_2 \\
                y &= c_3 x^{-2} \\
                x^2 y &= c_3 .
            \end{align*}
    \end{enumerate}
    
\end{problem}

\begin{problem}{Problem set 1, Q1 (iii, iv)}{}
        
    \marginnote{Second-order ODEs (incl. complex solutions).}

    Find general solutions of:
    \begin{enumerate}
        \item $u''+ 2u' + 2u = 0$
        \item $u'' + 6u' + 9 = 0$
    \end{enumerate}

    \tcblower
    
    \begin{enumerate}
        \item Solutions to characteristic polynomial are
            $$ r = -1 \pm i , $$
        and so
            \begin{align*}
                u(x) &= c_1 e^{(-1 + i)x} + c_2 e^{(-1 - i)x} \\
                &= e^x \biggl( 
                    c_1 (\cos x + i\sin x) 
                    + c_2 (\cos x - i\sin x) \biggr) \\
                &= e^x \biggl( c_3 \cos x
                    + c_4 \sin x \biggr) \\
                &= c_5 e^x \sin(x - c_6) .
            \end{align*}
        \item Characteristic polynomial factorises to $(r + 3)^2 = 0$, so the solution is
            $$ u(x) = e^{-3x} (c_1 + c_2 x) . $$
    \end{enumerate}

\end{problem}

\begin{problem}{Problem set 1, Q3}{}

    \marginnote{Selected ODEs with initial conditions.}

    Solve:
    \begin{enumerate}
        \item $t \frac{dx}{dt} = x + \sqrt{t^2 + x^2}$ with $x(1) = 0$
        \item $2xe^y + e^x + (x^2 + 1) e^y \frac{dy}{dx} = 0$ with $y = 0$ when $x = 0$
    \end{enumerate}

    \tcblower

    \begin{enumerate}
        \item Use the substitution $x = v(t) \cdot t$, which yields
            $$ v' = \frac{1}{t} \sqrt{1 + v^2} . $$
        Separable method:
            \begin{align*}
                \int \frac{1}{\sqrt{1 + v^2}} dv 
                    &= \int \frac{1}{t} dt \\
                \arcsinh(v) &= \ln \lvert t \rvert + c_1 \\
                x &= t \sinh \bigl( \ln \lvert t \rvert + c_1 \bigr)
            \end{align*}
        Initial conditions give $c_1 = 0$, so
            \begin{align*}
                x &= t \sinh \bigl( \ln \lvert t \rvert \bigr) \\
                &= t \frac{e^{\ln \lvert t \rvert}
                    - e^{-\ln \lvert t \rvert}}{2} \\
                &= \frac{t^2 - 1}{2} .
            \end{align*}
        \item \marginnote{[Exact ODE.]} Note that the exactness criterion holds, so we have
            $$ \int \frac{d}{dx} \bigl( 
                    (x^2 + 1)e^y \bigr) dx 
                    = \int -e^x dx , $$
        which yields
            \begin{align*}
                (x^2 + 1) e^y = -e^x + C ,
            \end{align*}
        whereby we find $C = 2$.
    \end{enumerate}

\end{problem}

\begin{problem}{Problem set 1, Q5}{}

    \marginnote{Reduction of order.}

    Given that $u_1 = \sin x$ is a solution of
        $$ xu'' - u' + 4x^3 u = 0 , $$
    use reduction of order to find a second, linearly independent solution.

    \tcblower

    Reduction of order technique:
        \begin{align*}
            u &= \sin x^2
                \int \frac{1}{\sin^2 x^2 \operatorname{exp}
                    \bigl\{ \int \frac{1}{x} \bigr\} dx } dx \\
            &= \sin x^2 \int \frac{x}{\sin^2 x^2} dx \\
            &= \sin x^2 \cdot (-\frac{1}{2} \cot x^2 + c_1) \\
            &= -\frac{1}{2} \cos x^2 + c_1 \sin x^2 .
        \end{align*}
    We can therefore take $-\frac{1}{2} \cos x^2$ as the second solution.

\end{problem}

\begin{problem}{Problem set 1, Q6}{}

    \marginnote{Reduction of order, interesting IBP.}

    Given that $u_1 = 1 + x$ is a solution of
        $$ xu'' - (1 + x)u' + u = 0 , $$
    use reduction of order to find the general solution.

    \tcblower

    Using the method of reduction of order:
        \begin{align*}
            u &= (1 + x) \int \frac{1}{(1 + x)^2 \operatorname{exp}
                \bigl\{ \int -\frac{1+x}{x} dx \bigr\}} dx \\
            &= c_1 (1 + x) \int \frac{x e^x}{(1 + x)^2} dx \\
            &= c_1 (1 + x) \int x e^x \frac{d}{dx}
                \cdot \biggl( \frac{-1}{1 + x} \biggr) dx \\
            &= c_1 (1 + x) \biggl[ 
                \frac{-x e^x}{1 + x}
                + \int \frac{e^x (1 + x)}{1 + x} dx \biggr] 
                \qquad \text{(IBP)} \\
            &= e^x + c_2 (x + 1) .
        \end{align*}
    Hence another particular solution is $e^x$, so the general solution is
        $$ u_G(x) = Ae^x + B(1 + x) . $$

\end{problem}

\subsection{Wronskian}

    \begin{align*}
        \text{set of functions linearly dependent} &\implies W(x) = 0 \\
        \text{set of functions linearly independent} &\impliedby W(x) \neq 0 \ \text{at at least one point}
    \end{align*}

For solutions to a non-singular, linear, homogeneous, $m$th-order ODE $Lu = 0$ on $[a, b]$, there are one of two cases:
    \begin{align*}
        W(x) & = 0 \
            \text{and the $m$ solutions are linearly \textit{dependent}} \\
        W(x) &\neq 0 \
            \text{and the $m$ solutions are linearly \textit{independent}}
    \end{align*}

\begin{problem}{Problem set 1, Q10}{}

    \marginnote{Wronskian satisfying first-order ODE.}

    For each of the following ODEs, write down the linear, first-order ODE satisfied by the Wronskian $W$ of any two, linearly independent solutions, and hence find the form of $W$.

    \begin{enumerate}
        \item $(1 - x^2) u'' - 2 x u' + \nu (\nu + 1) = 0$ \quad (Legendre's equation of order $\nu$)
        \item $x^2 u'' + xu' + x^2 u = 0$ \quad (Bessel's equation of order $0$)
    \end{enumerate}

    \tcblower

    \begin{enumerate}
        \item The Wronskian $W$ satisfies
            $$ (1 - x^2)W' - 2xW = 0 , $$
        a separable equation that yields the solution
            $$ W = \frac{c}{1 - x^2} . $$
        \item The Wronskian satisfies
            $$ x^2 W' + xW = 0 , $$
        a separable equation that gives
            $$ W = \frac{c}{x} . $$
    \end{enumerate}

\end{problem}

\begin{problem}{Problem set 1, Q11}{}

    \marginnote{Wronskians: important edge cases.}

    Compute the Wronskian for each set of functions and then determine whether or not they are linearly independent on the given interval.

    \begin{enumerate}
        \item $x^3, \lvert x \rvert^3$ on $\mathbb{R}$
        \item $e^{\lambda x}, xe^{\lambda x}, x^2 e^{\lambda x}$ on $[a, b]$
    \end{enumerate}

    \tcblower

    \begin{enumerate}
        \item For $x \geq 0$ and $x < 0$, the Wronskians are respectively
            $$ 
                \begin{vmatrix}
                    x^3 & x^3 \\
                    3x^2 & 3x^2
                \end{vmatrix}
                \qquad \text{and} \qquad
                \begin{vmatrix}
                    x^3 & -x^3 \\
                    3x^2 & -3x^2
                \end{vmatrix} .
            $$
        In both cases the determinant is $0$, however we can set up the equation
            $$ ax^3 + b \lvert x \rvert^3 = 0 , $$
        and, substituting (for example) $x = 1$ and $x = -1$ shows $a = b = 0$ so the two functions are, in fact, linearly independent.
        \item Using the Wolfram Mathematica command
            \begin{center}
                \lstinline|Wronskian[{E^(d x), x E^(d x), x^2 E^(d x)}, x]|
            \end{center}
        gives the result $2 e^{\lambda x}$. Therefore, the functions are linearly independent.
    \end{enumerate}

\end{problem}

\subsection{Variation of parameters}

We seek $v_1$ and $v_2$ such that
    $$ u_P(x) = v_1(x) u_1(x) + v_2(x) u_2(x) , $$
with the following AnsÃ¤tze:
    $$ v_1'(x) = \frac{-u_2(x) f(x)}{W(x)}
        \qquad \text{and} \qquad
        v_2'(x) = \frac{u_1(x) f(x)}{W(x)} , $$
where $W(x)$ is the Wronskian of $u_1$ and $u_2$.

\begin{problem}{Problem set 1, Q12}{}

    \marginnote{Variation of parameters.}

    Use the technique of \textit{variation of parameters} to find the general solution to each of the following inhomogeneous ODEs.

    \begin{enumerate}
        \item $u'' - u = \frac{2}{1 + e^x}$
        \item $u'' + u = \cosec x$
        \item $u'' + 2u' + u = e^{-x} \sec^2 x$
    \end{enumerate}

    \tcblower

    \begin{enumerate}
        \item \marginnote{[Easy.]} The characteristic equation gives solutions $\pm 1$, so the homogeneous solution is
            $$ u_H(x) = c_1 e^x + c_2 e^{-x} . $$
        Using variation of parameters then gives
            \begin{align*}
                v_1'(x) &= \frac{-e^{-x} \cdot
                \frac{2}{1 + e^x}}{1 + e^x}
                    = \frac{1}{e^x (1 + e^x)} \\
                v_2'(x) &= \frac{e^x \cdot
                    \frac{2}{1 + e^x}}{1 + e^x}
                    = \frac{-e^x}{1+e^x} .
            \end{align*}
        Integrating, we find
            $$ v_1(x) = -e^{-x} - x + \log(1 + e^x) + c_3 $$
        and
            $$ v_2(x) = -\log(1 + e^x) + c_4 . $$
        \underline{Note}: for $v_1(x)$, use partial fractions and an $1 + e^x - e^x$ trick.

        Hence
            $$ u_P(x) = e^x \bigl[ c_3 + \log(1 + e^x) - x \bigr]
                + e^{-x} \bigl[ c_4 - \log(1 + e^x) \bigr] - 1 , $$
        and of course $u_G(x) = u_P(x) + u_H(x)$.
        \item \marginnote{[Complex solutions.]} We find the homogeneous solution to be
            $$ u_H(x) = c_1 \cos x + c_2 \sin x , $$
        whereby the Wronskian is $1$. Using variation of parameters,
            \begin{align*}
                v_1'(x) &= -\sin x \cdot \cosec x = -1 \\
                v_2'(x) &= \cos x \cdot \cosec x = \cot x .
            \end{align*}
        and so
            $$ v_1(x) = -x + c_3 \qquad \text{and} \qquad
                v_2(x) = \log(\sin x) + c_4 . $$
        Therefore
            $$ u_P(x) = \cos x (-x + c_3) +
                \sin x (\log(\sin x) + c_4) $$
        and so
            $$ u_G(x) = -x \cos x + \sin x \log \lvert \cos x \rvert
                + A \cos x + B \sin x . $$
        \item \marginnote{[Difficult integral.]} Homogeneous solution:
            $$ u_H(x) = c_1 e^{-x} + c_2 x e^{-x} . $$
        Wronskian is $e^{-2x}$. We therefore have
            $$ v_1'(x) = -x \sec^2 x 
                \qquad \text{and} \qquad
                v_2'(x) = \sec^2 x , $$
        which gives
            $$ v_1(x) = -\log \lvert \cos x \rvert - x \tan x
                \qquad \text{and} \qquad
                v_2(x) = \tan x . $$
        Hence
            $$ u_G(x) = -e^{-x} \log \lvert \cos x \rvert 
                + Ae^{-x} + Bxe^{-x} . $$
    \end{enumerate}

\end{problem}

  